# Technology Detection Service Configuration
# Unified detection of server-side, client-side, and framework technologies

general:
  # Concurrency settings
  max_workers: 5
  timeout: 10
  verify_ssl: false
  follow_redirects: true

  # User agent for HTTP requests
  user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

# Server-side technology detection via whatweb
whatweb:
  enabled: true
  normalize_names: true

  # Technology name mappings for normalization
  technology_map:
    "Apache": "Apache"
    "HTTPServer": "Apache"
    "nginx": "Nginx"
    "Tomcat": "Tomcat"
    "Jenkins": "Jenkins"
    "OpenSSH": "OpenSSH"
    "OpenSSL": "OpenSSL"
    "PHP": "PHP"
    "MySQL": "MySQL"
    "PostgreSQL": "PostgreSQL"
    "Redis": "Redis"
    "MongoDB": "MongoDB"
    "WordPress": "WordPress"
    "Drupal": "Drupal"
    "Joomla": "Joomla"
    "Express": "Express"
    "Django": "Django"
    "Ruby": "Ruby"
    "Ruby on Rails": "Rails"
    "ASP.NET": "ASP.NET"
    "IIS": "IIS"
    "Windows": "Windows"
    "Linux": "Linux"
    "CentOS": "CentOS"
    "Ubuntu": "Ubuntu"
    "Debian": "Debian"
    "Fedora": "Fedora"
    "Alpine": "Alpine"
    "Docker": "Docker"
    "Kubernetes": "Kubernetes"

# JavaScript library detection
javascript_libraries:
  enabled: true
  detect_versions: true

  # Library detection patterns (regex)
  libraries:
    jquery:
      pattern: 'jquery[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    react:
      pattern: 'react[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    angular:
      pattern: 'angular[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    vue:
      pattern: 'vue[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    bootstrap:
      pattern: 'bootstrap[.-](\d+\.\d+(\.\d+)?)'
      type: 'framework'
    tailwind:
      pattern: 'tailwind[.-](\d+\.\d+(\.\d+)?)'
      type: 'framework'
    foundation:
      pattern: 'foundation[.-](\d+\.\d+(\.\d+)?)'
      type: 'framework'
    bulma:
      pattern: 'bulma[.-](\d+\.\d+(\.\d+)?)'
      type: 'framework'
    moment:
      pattern: 'moment[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    underscore:
      pattern: 'underscore[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    lodash:
      pattern: 'lodash[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'
    d3:
      pattern: 'd3[.-](\d+\.\d+(\.\d+)?)'
      type: 'library'

# Framework detection
frameworks:
  enabled: true

  frameworks:
    - name: "React"
      indicators: ["react", "reactDOM"]
    - name: "Vue.js"
      indicators: ["vue.js", "vue.esm"]
    - name: "Angular"
      indicators: ["angular.js", "@angular"]
    - name: "Next.js"
      indicators: ["__NEXT_DATA__", "next.js"]
    - name: "Gatsby"
      indicators: ["gatsby"]
    - name: "Svelte"
      indicators: ["svelte"]

# Default page detection
default_pages:
  enabled: true

  signatures:
    apache:
      - "It works!"
      - "Apache2 Ubuntu Default Page"
    nginx:
      - "Welcome to nginx!"
    iis:
      - "IIS Windows Server"
      - "Welcome to IIS"
    tomcat:
      - "Apache Tomcat"
    ngrok:
      - "Tunnel"
      - "ngrok"

# Debug endpoint discovery
debug_endpoints:
  enabled: true
  timeout: 3

  # Common debug/test endpoints
  endpoints:
    - "/debug"
    - "/admin/debug"
    - "/test.js"
    - "/config.js"
    - "/_profiler"
    - "/phpinfo.php"
    - "/info.php"
    - "/.env"
    - "/actuator/health"
    - "/api/debug"
    - "/.git"
    - "/.svn"
    - "/api/v1/swagger.json"
    - "/swagger.json"
    - "/api-docs"
    - "/admin"
    - "/wp-admin"

# Output settings
output:
  # Format: csv, json, both
  format: "csv"

  # Include these fields in output
  fields:
    - target
    - domain
    - default_page
    - debug_paths
    - server_technologies
    - client_technologies

  # Group technologies by category
  group_by_category: true
